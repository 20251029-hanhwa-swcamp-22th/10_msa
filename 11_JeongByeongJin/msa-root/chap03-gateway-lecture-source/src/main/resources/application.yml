server:
  port: 8000  # Gateway ??? 8000? ???? ?? ??

spring:
  application:
    name: gateway-server  # Eureka? ??? Gateway ??
  cloud:
    gateway:
      # Netty ??? ??? ? ??(WebFlux) ??? ??
      server:
        webflux:
          routes:
            # --- [? ?? ??? ??? ??] ---
            - id: 1st-service
              # lb:// ??: Load Balancer. Eureka? ??? '1ST-SERVICE'?? ??? ????,
              # ?? ????? ?? ?? ?????(????)? ??
              uri: lb://1ST-SERVICE
              predicates:
                # ??: ???? 'http://gateway:8000/first-service/**'? ??? ??? ? ??? ???
                - Path=/first-service/**
              filters:
                # 1. ?? ???:
                #    ??? ?? '/first-service/health' -> ??? ?? '/health'
                #    (?<segment>.*)? ??? ??? ??? ???? $\{segment}? ??
                - RewritePath=/first-service/(?<segment>.*), /$\{segment}

                # 2. ?? ?? (????):
                #    ??? ???(1st-service)? ?? ? 'first-request' ??? ??? ??
                - AddRequestHeader=first-request, first-request-value

                # 3. ?? ?? ?? (????):
                #    ????? ??? ? ? 'first-response' ??? ??? ??
                - AddResponseHeader=first-response, first-response-value

            # --- [? ?? ??? ??? ??] ---
            - id: 2nd-service
              uri: lb://2ND-SERVICE
              predicates:
                - Path=/second-service/**
              filters:
                - RewritePath=/second-service/(?<segment>.*), /$\{segment}
                - AddRequestHeader=second-request, second-request-value
                - AddResponseHeader=second-response, second-response-value

# Eureka Server(?????) ??
eureka:
  client:
    register-with-eureka: true  # Gateway? Eureka? ??? ??
    fetch-registry: true        # ?? ????? ?? ??? ??? (???? ?? ??).
    service-url:
      defaultZone: http://localhost:8761/eureka

# JWT ?? ??? ?? ??? ??
jwt:
  secret: LH9QZL8upsPBfuDY+Dkb1kT9DZIIUSuA2u4O6Lfi3mkEfeWtETpVTcR/8SMZdJWn/xNTuCQBE6rBvDXgnVmscQ==